---
title: "null"
author: "null"
date: "null"
output:
  html_document:
    df_print: paged
header-includes:
- \usepackage{amsthm}
- \usepackage{xcolor}
documentclass: article
<!---output: beamer_presentation--->
---





<!--- Below are global settings for knitr. You can override any of them by adding the changes to individual chunks --->

```{r global_options, include=FALSE}
knitr::opts_chunk$set(error=TRUE,        # Keep compiling upon error
                      collapse=TRUE,     # collapse by default
                      echo=TRUE,         # echo code by default
                      comment = "#>",    # change comment character
                      fig.width = 7,     # set figure width
                      out.width = "100%", # set width of displayed images
                      warning=TRUE,      # show R warnings
                      message=FALSE)     # show R messages
```


<!--- Solution Region --->
<style>
#solution {
  background-color: #8FBC8F;
  border-style: solid;
  border-color: blue;
  margin-left: 20px;
  margin-bottom: 15px;
  padding: 5px;
}
</style>



<!---**Wintersemester 2016 |Studiengang Data Science | Hochschule Darmstadt **--->




\theoremstyle{definition}
\newtheorem{auf}{Aufgabe}

\newcommand{\R}{{\sffamily R} }

\begin{centering}
%\vspace{-2 cm}
\Huge
{\bf ?bung 10}\\
\Large
Explorative Datenanalyse und Visualisierung\\
\normalsize
Wintersemester 2019\\
S. D?hler, B. Nedic (FBMN, h\_da)\\
\end{centering}


\hrulefill

**Name: Doess, Rohrer**

**Punkte:**

\hrulefill


\setcounter{auf}{21} 
\begin{auf}
Auf der Moodle-Seite zur Vorlesung finden Sie 4 verschiedene zweidimensionale Datens?tze.
\begin{itemize}
    \item[a)] Ermitteln Sie in jedem Fall $\overline{x},\overline{y},s_x,s_y$ und $r_{xy}$. Was f?llt Ihnen auf?
    \item[b)] Ermitteln Sie in allen 4 F?llen das Regressionsmodel und die Regressionsgerade. Benutzen Sie hierf?r den {\ttfamily lm}-Befehl.
    \item[c)] Schreiben Sie eine Funktion {\ttfamily plot.regression}. Als Argumente sollen dieser Funktion ?bergeben werden:
    \begin{itemize}
          \item {\ttfamily daten}: Ein Datensatz
          \item {\ttfamily model}: Das zugeh?rige {\ttfamily lm}-Objekt
          \item {\ttfamily header}: Eine ?berschrift
          \item {\ttfamily x.lim,y.lim}: Wertebereich der $x$- und $y$-Achse
    \end{itemize}
    Als Output soll die Funktion einen Scatterplot der Daten (auf den ?bergebenen Wertebereichenen) mit zugeh?riger Regressionsgerade sowie eines Titels liefern.
    \item[d)] Plotten Sie die 4 Scatterplots inklusive ihrer Regressionsgeraden in einem gemeinsamen Grafikpanel. Benutzen Sie die Funktion {\ttfamily plot.regression}. 
    \item[e)] F?hren Sie f?r die 4 Datens?tze jeweils eine Residuenanalyse durch und interpretieren Sie die Ergebnisse.
\end{itemize}
Interpretieren Sie die Ergebnisse.
\end{auf}

\paragraph{L?sung} <!---Hier Schreiben Sie--->



\paragraph{Anmerkungen/Korrektur} <!---Hier schreibt der Tutor--->

\textcolor{gray}{\hrulefill}

\begin{auf}
Arbeiten Sie weiter an dem Datensatz {\ttfamily UmfrageBis2019.csv} (s. Aufgabe 21).
\begin{itemize}
    \item[a)] Untersuchen Sie, ob und wenn ja, welcher Zusammenhang zwischen den Merkmalen 'Fussballfan' und 'Geschlecht' besteht. Erzeugen Sie hierzu eine Vierfeldertafel und einen Mosaicplot mit geeigneten R-Befehlen.
    \item[b)] Untersuchen Sie, die gleiche Fragestellung wie in a) bei  den Merkmalen 'Musikalitaet' und 'Geschlecht'. Was unterscheidet das Merkmal 'Musikalitaet' vom Merkmal 'Fussballfan'? Wie sollte man das in der Analyse ber?cksichtigen?
    \item[c)] Untersuchen Sie, die gleiche Fragestellung wie in a) bei  den Merkmalen 'Musikalitaet' und 'Haarfarbe'.
    \item[d)] In welchen der 3 obigen Situation scheint der Mosaicplot am ehesten auf Unabh?ngigkeit der Merkmale hinzudeuten? Begr?nden Sie Ihre Antwort!
\end{itemize}
\end{auf}


   
\paragraph{L?sung} <!---Hier Schreiben Sie--->

```{r}
reg1 <- read.csv(file="Reg1.csv", header=TRUE, sep=",")
reg2 <- read.csv(file="Reg2.csv", header=TRUE, sep=",")
reg3 <- read.csv(file="Reg3.csv", header=TRUE, sep=",")
reg4 <- read.csv(file="Reg4.csv", header=TRUE, sep=",")
```
22a)

```{r}
calculate_a <- function(x,y){
  
  mean_x <- mean(x)
  mean_y <- mean(y)
  sd_x <- sd(x)
  sd_y <- sd(y)
  cor_x <- cor(x, y, use = "everything",
        method = "pearson")
  return <- c(mean_x, mean_y, sd_x, sd_y, cor_x)
}

df1 <- data.frame(matrix(ncol = 5, nrow = 0))
x <- c("mean_x", "mean_y", "sd_x", "sd_y", "cor_xy")
colnames(df1) <- x

df1 <- rbind(df1, calculate_a(reg1$x1, reg1$y1))
df1 <- rbind(df1, calculate_a(reg2$x2, reg2$y2))
df1 <- rbind(df1, calculate_a(reg3$x3, reg3$y3))
df1 <- rbind(df1, calculate_a(reg4$x4, reg4$y4))

```
Was fällt auf: Obwohl die vier Verteilungen sehr unterschiedlich sind, sind die errechneten Werte jeweils sehr ähnlich.

22b)

```{r}
lm(reg1$y1~reg1$x1)
reg1_line <- function(x){0.5001*x + 3.0001}
lm(reg2$y2~reg2$x2)
reg2_line <- function(x){0.500*x + 3.001}
lm(reg3$y3~reg3$x3)
reg3_line <- function(x){0.4997*x + 3.0025}
lm(reg4$y4~reg4$x4)
reg4_line <- function(x){0.4999*x + 3.0017}
```
22c) 

```{r}
plot.regression <- function(data, model, header, x, y){
  plot(data, xlim=x, ylim=y, main=header)
  abline(model, col = "red")
}
```

22d)

```{r}
par(mfrow=c(2,2))
plot.regression(reg1, lm(reg1$y1~reg1$x1), "Plot 1", range(0,20), range(0,13))
plot.regression(reg2, lm(reg2$y2~reg2$x2), "Plot 2", range(0,20), range(0,13))
plot.regression(reg3, lm(reg3$y3~reg3$x3), "Plot 3", range(0,20), range(0,13))
plot.regression(reg4, lm(reg4$y4~reg4$x4), "Plot 4", range(0,20), range(0,13))
```
22e)
 
```{r}
```

23a)

```{r}
data2019 <- read.csv(file="UmfrageBis2019.csv", header=TRUE, sep=";")

table(data2019$Geschlecht, data2019$Fussballfan)

install.packages("vcd")
library(vcd)
table <- structable(data2019$Geschlecht ~ data2019$Fussballfan)
mosaic(table, shade = TRUE, legend = TRUE)
```
Interpretation: Als Mann ist man eher Fußballfan
\paragraph{Anmerkungen/Korrektur} <!---Hier schreibt der Tutor--->

\textcolor{gray}{\hrulefill}


